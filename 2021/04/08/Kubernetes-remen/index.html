<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Kubernetes入门-进阶实战 | 张天师</title>
  <meta name="keywords" content=" Kubernetes ">
  <meta name="description" content="Kubernetes入门-进阶实战 | 张天师">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="本博客hexo主题基于hexo-theme-3-hexo 修改而来 https:&#x2F;&#x2F;github.com&#x2F;yelog&#x2F;hexo-theme-3-hexo">
<meta property="og:type" content="website">
<meta property="og:title" content="about">
<meta property="og:url" content="http://zhangyu.info/about/index.html">
<meta property="og:site_name" content="张天师">
<meta property="og:description" content="本博客hexo主题基于hexo-theme-3-hexo 修改而来 https:&#x2F;&#x2F;github.com&#x2F;yelog&#x2F;hexo-theme-3-hexo">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-15T13:48:47.000Z">
<meta property="article:modified_time" content="2021-03-15T15:05:42.638Z">
<meta property="article:author" content="张天师">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/favicon.ico">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="张天师" type="application/atom+xml">
</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>张天师</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/mayou33"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(64)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="linux">
                        
                        linux
                        <small>(4)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="架构">
                        
                        架构
                        <small>(4)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="监控">
                        
                        监控
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="nginx">
                        
                        nginx
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="API网关">
                        
                        API网关
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="containerd">
                        
                        containerd
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Ingress">
                        
                        Ingress
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="k8s">
                        
                        k8s
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Kafka">
                        
                        Kafka
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Kubernetes">
                        
                        Kubernetes
                        <small>(9)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="mysql">
                        
                        mysql
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="nacos">
                        
                        nacos
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="OKR">
                        
                        OKR
                        <small>(3)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="PaaS">
                        
                        PaaS
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="redis">
                        
                        redis
                        <small>(3)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Scrum">
                        
                        Scrum
                        <small>(11)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="SpringBoot">
                        
                        SpringBoot
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="SRE">
                        
                        SRE
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="优化">
                        
                        优化
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="公有云">
                        
                        公有云
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="安全">
                        
                        安全
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="微服务">
                        
                        微服务
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="我假装讲-你假装看">
                        
                        我假装讲-你假装看
                        <small>(4)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="日志">
                        
                        日志
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="消息系统">
                        
                        消息系统
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="职业发展">
                        
                        职业发展
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="64">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://blog.csdn.net/shaochenshuo">数据库shao</a></li>
            
            <li><a target="_blank" href="https://blog.huoding.com/">火丁笔记</a></li>
            
            <li><a target="_blank" href="https://canon88.github.io/">网络安全canon</a></li>
            
            <li><a target="_blank" href="https://www.tecmint.com/">linux学习</a></li>
            
            <li><a target="_blank" href="https://www.makelinux.net/reference/">linux技术参考</a></li>
            
            <li><a target="_blank" href="https://coolshell.cn">酷壳CoolShell</a></li>
            
            <li><a target="_blank" href="http://www.brendangregg.com/">Systems-Performance</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>API网关</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Cilium</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>containerd</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>flannel</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Ingress</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>k8s</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Kafka</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Kubernetes</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>mysql</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>nacos</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>nginx</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>OKR</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PaaS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Pulsar</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>redis</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Scrum</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SpringBoot</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SRE</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>优化</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>公有云</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>安全</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>微服务</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>性能</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>我假装讲-你假装看</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>日志</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>架构</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>监控</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>职业发展</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        <a  class="全部文章 linux "
           href="/2023/03/08/Linux%E4%B8%ADCPU%E5%88%A9%E7%94%A8%E7%8E%87%E6%98%AF%E5%A6%82%E4%BD%95%E7%AE%97%E5%87%BA%E6%9D%A5%E7%9A%84/"
           data-tag="linux"
           data-author="" >
            <span class="post-title" title="Linux中CPU利用率是如何算出来的">Linux中CPU利用率是如何算出来的</span>
            <span class="post-date" title="2023-03-08 00:00:00">2023/03/08</span>
        </a>
        
        <a  class="全部文章 安全 "
           href="/2023/01/03/%E5%A4%9A%E5%B0%91%E9%81%93%E9%98%B2%E7%BA%BF%E6%89%8D%E8%83%BD%E6%8C%A1%E4%BD%8F%E9%A1%B6%E5%B0%96%E9%BB%91%E5%AE%A2/"
           data-tag="安全"
           data-author="" >
            <span class="post-title" title="多少道防线才能挡住顶尖黑客？">多少道防线才能挡住顶尖黑客？</span>
            <span class="post-date" title="2023-01-03 00:00:00">2023/01/03</span>
        </a>
        
        <a  class="全部文章 架构 "
           href="/2023/01/03/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%88%B0%E5%BA%95%E6%98%AF%E4%B8%AA%E5%95%A5/"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="云原生到底是个啥">云原生到底是个啥</span>
            <span class="post-date" title="2023-01-03 00:00:00">2023/01/03</span>
        </a>
        
        <a  class="全部文章 Kafka "
           href="/2023/01/03/%E8%B0%81%E5%86%8D%E9%97%AE%E6%88%91Kafka-%E6%88%91%E6%8A%8A%E8%BF%9943%E5%BC%A0%E5%9B%BE%E7%94%A9%E7%BB%99%E4%BB%96/"
           data-tag="Kafka"
           data-author="" >
            <span class="post-title" title="谁再问我Kafka-我把这43张图甩给他">谁再问我Kafka-我把这43张图甩给他</span>
            <span class="post-date" title="2023-01-03 00:00:00">2023/01/03</span>
        </a>
        
        <a  class="全部文章 redis "
           href="/2022/12/05/redis%E7%9A%8420%E7%A7%8D%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"
           data-tag="redis"
           data-author="" >
            <span class="post-title" title="redis的20种常见使用场景">redis的20种常见使用场景</span>
            <span class="post-date" title="2022-12-05 00:00:00">2022/12/05</span>
        </a>
        
        <a  class="全部文章 OKR "
           href="/2022/11/30/OKR%E4%B9%8B%E5%89%91%C2%B7%E7%90%86%E5%BF%B5%E7%AF%8703-OKR%E7%90%86%E5%BF%B5%E8%AE%A4%E5%90%8C/"
           data-tag="OKR"
           data-author="" >
            <span class="post-title" title="OKR之剑·理念篇03-OKR理念认同">OKR之剑·理念篇03-OKR理念认同</span>
            <span class="post-date" title="2022-11-30 00:00:00">2022/11/30</span>
        </a>
        
        <a  class="全部文章 linux "
           href="/2022/11/30/Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"
           data-tag="linux"
           data-author="" >
            <span class="post-title" title="Linux性能优化">Linux性能优化</span>
            <span class="post-date" title="2022-11-30 00:00:00">2022/11/30</span>
        </a>
        
        <a  class="全部文章 linux "
           href="/2022/11/17/%E7%BD%91%E5%8D%A1%E9%99%90%E9%80%9F%E5%B7%A5%E5%85%B7%E4%B9%8BWonderShaper/"
           data-tag="linux"
           data-author="" >
            <span class="post-title" title="网卡限速工具之WonderShaper">网卡限速工具之WonderShaper</span>
            <span class="post-date" title="2022-11-17 00:00:00">2022/11/17</span>
        </a>
        
        <a  class="全部文章 OKR "
           href="/2022/11/17/OKR%E4%B9%8B%E5%89%91.%E7%90%86%E5%BF%B5%E7%AF%8702-OKR%E5%B8%83%E9%81%93%E4%B9%8B%E6%97%85/"
           data-tag="OKR"
           data-author="" >
            <span class="post-title" title="OKR之剑·理念篇02-OKR布道之旅">OKR之剑·理念篇02-OKR布道之旅</span>
            <span class="post-date" title="2022-11-17 00:00:00">2022/11/17</span>
        </a>
        
        <a  class="全部文章 mysql "
           href="/2022/11/17/%E6%90%9E%E6%87%82MySQL%E6%98%AF%E6%80%8E%E4%B9%88%E5%8A%A0%E8%A1%8C%E7%BA%A7%E9%94%81%E7%9A%84/"
           data-tag="mysql"
           data-author="" >
            <span class="post-title" title="搞懂MySQL是怎么加行级锁的">搞懂MySQL是怎么加行级锁的</span>
            <span class="post-date" title="2022-11-17 00:00:00">2022/11/17</span>
        </a>
        
        <a  class="全部文章 OKR "
           href="/2022/11/02/OKR%E4%B9%8B%E5%89%91%C2%B7%E7%90%86%E5%BF%B5%E7%AF%8701-OKR%E5%B8%A6%E7%BB%99%E6%88%91%E4%BB%AC%E7%9A%84%E6%94%B9%E5%8F%98%E6%88%91%E4%BB%AC%E7%9A%84%E6%94%B9%E5%8F%98/"
           data-tag="OKR"
           data-author="" >
            <span class="post-title" title="OKR之剑·理念篇01-OKR带给我们的改变我们的改变">OKR之剑·理念篇01-OKR带给我们的改变我们的改变</span>
            <span class="post-date" title="2022-11-02 00:00:00">2022/11/02</span>
        </a>
        
        <a  class="全部文章 redis "
           href="/2022/10/26/redis%E7%9A%84%E5%A4%A7Key%E5%AF%B9%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%89%E4%BB%80%E4%B9%88%E5%BD%B1%E5%93%8D/"
           data-tag="redis"
           data-author="" >
            <span class="post-title" title="redis的大Key对持久化有什么影响">redis的大Key对持久化有什么影响</span>
            <span class="post-date" title="2022-10-26 00:00:00">2022/10/26</span>
        </a>
        
        <a  class="全部文章 redis "
           href="/2022/10/26/redis%E7%9A%84%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"
           data-tag="redis"
           data-author="" >
            <span class="post-title" title="redis的常见使用场景">redis的常见使用场景</span>
            <span class="post-date" title="2022-10-26 00:00:00">2022/10/26</span>
        </a>
        
        <a  class="全部文章 微服务 "
           href="/2022/05/28/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"
           data-tag="微服务"
           data-author="" >
            <span class="post-title" title="云原生微服务最佳实践">云原生微服务最佳实践</span>
            <span class="post-date" title="2022-05-28 00:00:00">2022/05/28</span>
        </a>
        
        <a  class="全部文章 微服务 "
           href="/2022/05/28/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E6%9C%80%E4%BD%B3%E8%B0%83%E7%94%A8%E6%96%B9%E5%BC%8F/"
           data-tag="微服务"
           data-author="" >
            <span class="post-title" title="微服务之间的最佳调用方式">微服务之间的最佳调用方式</span>
            <span class="post-date" title="2022-05-28 00:00:00">2022/05/28</span>
        </a>
        
        <a  class="全部文章 nacos "
           href="/2022/05/01/%E8%A7%A3%E5%86%B3gateway%E4%BD%BF%E7%94%A8nacos%E9%87%8D%E5%90%AF%E6%8A%A5503ServiceUnavailable%E9%97%AE%E9%A2%98/"
           data-tag="nacos"
           data-author="" >
            <span class="post-title" title="解决gateway使用nacos重启报503ServiceUnavailable问题">解决gateway使用nacos重启报503ServiceUnavailable问题</span>
            <span class="post-date" title="2022-05-01 00:00:00">2022/05/01</span>
        </a>
        
        <a  class="全部文章 监控 "
           href="/2022/05/01/%E4%BB%8E%E7%9B%91%E6%8E%A7%E5%88%B0%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7%EF%BC%8C%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3%E3%80%81%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E3%80%81%E8%81%8C%E8%B4%A3%E5%88%86%E5%B7%A5%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%8F%98%E5%8C%96/"
           data-tag="监控"
           data-author="" >
            <span class="post-title" title="从监控到可观测性，设计思想、技术选型、职责分工都有哪些变化">从监控到可观测性，设计思想、技术选型、职责分工都有哪些变化</span>
            <span class="post-date" title="2022-05-01 00:00:00">2022/05/01</span>
        </a>
        
        <a  class="全部文章 SpringBoot "
           href="/2022/04/30/SpringBoot%E6%80%A7%E8%83%BD%E5%A4%AA%E5%B7%AE,%E6%95%99%E4%BD%A0%E5%87%A0%E6%8B%9B%E8%BD%BB%E6%9D%BE%E6%90%9E%E5%AE%9A/"
           data-tag="SpringBoot"
           data-author="" >
            <span class="post-title" title="SpringBoot性能太差,教你几招轻松搞定">SpringBoot性能太差,教你几招轻松搞定</span>
            <span class="post-date" title="2022-04-30 00:00:00">2022/04/30</span>
        </a>
        
        <a  class="全部文章 API网关 "
           href="/2022/04/30/API%E7%BD%91%E5%85%B3%E7%9A%84%E5%8A%9F%E8%83%BD%E7%94%A8%E9%80%94%E5%8F%8A%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/"
           data-tag="API网关"
           data-author="" >
            <span class="post-title" title="API网关的功能用途及实现方式">API网关的功能用途及实现方式</span>
            <span class="post-date" title="2022-04-30 00:00:00">2022/04/30</span>
        </a>
        
        <a  class="全部文章 PaaS "
           href="/2022/04/30/%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84PaaS%E6%B7%B7%E5%90%88%E4%BA%91%E7%9A%84%E5%87%A0%E7%A7%8D%E5%BD%A2%E5%BC%8F/"
           data-tag="PaaS"
           data-author="" >
            <span class="post-title" title="基于容器的PaaS混合云的几种形式">基于容器的PaaS混合云的几种形式</span>
            <span class="post-date" title="2022-04-30 00:00:00">2022/04/30</span>
        </a>
        
        <a  class="全部文章 k8s "
           href="/2022/04/30/%E6%89%93%E7%A0%B4Dockershim%E7%A7%BB%E9%99%A4%E7%84%A6%E8%99%91,%E4%B8%94%E7%9C%8BRancher%E5%A6%82%E4%BD%95%E5%BA%94%E5%AF%B9/"
           data-tag="k8s"
           data-author="" >
            <span class="post-title" title="打破Dockershim移除焦虑,且看Rancher如何应对">打破Dockershim移除焦虑,且看Rancher如何应对</span>
            <span class="post-date" title="2022-04-30 00:00:00">2022/04/30</span>
        </a>
        
        <a  class="全部文章 API网关 "
           href="/2022/04/30/API%E7%BD%91%E5%85%B3%E4%B8%BAK8s%E5%AE%B9%E5%99%A8%E5%BA%94%E7%94%A8%E9%9B%86%E7%BE%A4%E6%8F%90%E4%BE%9B%E5%BC%BA%E5%A4%A7%E7%9A%84%E6%8E%A5%E5%85%A5%E8%83%BD%E5%8A%9B/"
           data-tag="API网关"
           data-author="" >
            <span class="post-title" title="API网关为K8s容器应用集群提供强大的接入能力">API网关为K8s容器应用集群提供强大的接入能力</span>
            <span class="post-date" title="2022-04-30 00:00:00">2022/04/30</span>
        </a>
        
        <a  class="全部文章 日志 "
           href="/2022/04/30/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E6%97%A5%E5%BF%97%E9%87%87%E9%9B%86-%E5%AD%98%E5%82%A8-%E5%88%86%E6%9E%90%E5%AE%9E%E8%B7%B5/"
           data-tag="日志"
           data-author="" >
            <span class="post-title" title="云原生环境下的日志采集、存储、分析实践">云原生环境下的日志采集、存储、分析实践</span>
            <span class="post-date" title="2022-04-30 00:00:00">2022/04/30</span>
        </a>
        
        <a  class="全部文章 公有云 "
           href="/2022/04/30/%E5%85%AC%E6%9C%89%E4%BA%91%E9%99%8D%E6%9C%AC%E5%A2%9E%E6%95%88%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"
           data-tag="公有云"
           data-author="" >
            <span class="post-title" title="公有云降本增效最佳实践">公有云降本增效最佳实践</span>
            <span class="post-date" title="2022-04-30 00:00:00">2022/04/30</span>
        </a>
        
        <a  class="全部文章 我假装讲-你假装看 "
           href="/2022/04/23/%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BA%92%E8%81%94%E7%BD%91%E5%A4%A7%E5%8E%82%E4%B8%80%E8%BE%B9%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%A3%81%E5%91%98%E5%8F%88%E4%B8%80%E8%BE%B9%E6%8B%9B%E8%81%98/"
           data-tag="我假装讲-你假装看"
           data-author="" >
            <span class="post-title" title="为什么互联网大厂一边大规模裁员又一边招聘">为什么互联网大厂一边大规模裁员又一边招聘</span>
            <span class="post-date" title="2022-04-23 00:00:00">2022/04/23</span>
        </a>
        
        <a  class="全部文章 linux "
           href="/2022/04/23/Linux%E7%9A%84CPU%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2%E6%B7%B1%E5%85%A5%E6%8E%A2%E8%AE%A8/"
           data-tag="linux"
           data-author="" >
            <span class="post-title" title="Linux的CPU上下文切换深入探讨">Linux的CPU上下文切换深入探讨</span>
            <span class="post-date" title="2022-04-23 00:00:00">2022/04/23</span>
        </a>
        
        <a  class="全部文章 架构 "
           href="/2022/04/23/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E5%8F%8A%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="微服务架构及设计模式">微服务架构及设计模式</span>
            <span class="post-date" title="2022-04-23 00:00:00">2022/04/23</span>
        </a>
        
        <a  class="全部文章 监控 "
           href="/2022/04/23/%E6%89%93%E9%80%A0%E4%B8%80%E5%A5%97%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8A%9F%E8%83%BD%E6%9C%80%E5%85%A8%E7%9A%84APM%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/"
           data-tag="监控"
           data-author="" >
            <span class="post-title" title="打造一套客户端功能最全的APM监控系统">打造一套客户端功能最全的APM监控系统</span>
            <span class="post-date" title="2022-04-23 00:00:00">2022/04/23</span>
        </a>
        
        <a  class="全部文章 架构 "
           href="/2022/04/23/%E4%BC%81%E4%B8%9A%E5%AE%8C%E6%88%90%E4%BA%91%E8%BD%AC%E5%9E%8B%E7%9A%84%E6%88%90%E5%8A%9F%E4%B9%8B%E9%81%93-%E4%BA%91%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86/"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="企业完成云转型的成功之道：云成本优化管理">企业完成云转型的成功之道：云成本优化管理</span>
            <span class="post-date" title="2022-04-23 00:00:00">2022/04/23</span>
        </a>
        
        <a  class="全部文章 优化 "
           href="/2022/04/12/%E8%B0%88%E8%B0%88%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E5%A5%BD%E7%BD%91%E7%AB%99%E7%9A%84URL/"
           data-tag="优化"
           data-author="" >
            <span class="post-title" title="谈谈如何设计好网站的URL">谈谈如何设计好网站的URL</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC01%E8%AF%BE-%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E5%92%8CScrumMaster%E5%9F%BA%E6%9C%AC%E5%8A%9F%E5%9B%9B%E9%83%A8%E6%9B%B2/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第01课-敏捷教练和ScrumMaster基本功四部曲">敏捷教练第01课-敏捷教练和ScrumMaster基本功四部曲</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC02%E8%AF%BE-%E5%82%A8%E5%A4%87-Scrum%E7%B2%BE%E8%A6%81/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第02课-储备-Scrum精要">敏捷教练第02课-储备-Scrum精要</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC03%E8%AF%BE-%E5%82%A8%E5%A4%87-%E7%94%A8%E6%88%B7%E6%95%85%E4%BA%8B%E7%B2%BE%E8%A6%81/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第03课-储备-用户故事精要">敏捷教练第03课-储备-用户故事精要</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC04%E8%AF%BE-%E5%82%A8%E5%A4%87-scrum%E7%9A%8420%E4%B8%AA%E5%AD%90%E6%A8%A1%E5%BC%8F/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第04课-储备-scrum的20个子模式">敏捷教练第04课-储备-scrum的20个子模式</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC05%E8%AF%BE-%E5%82%A8%E5%A4%87-%E7%B2%BE%E7%9B%8A%E4%BD%93%E7%B3%BB%E7%B2%BE%E8%A6%81/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第05课-储备-精益体系精要">敏捷教练第05课-储备-精益体系精要</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC08%E8%AF%BE-%E6%8A%80%E5%B7%A7-%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%9A%84%E5%85%AD%E8%84%89%E7%A5%9E%E5%89%91%EF%BC%88%E4%B8%8B%EF%BC%89/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第08课-技巧-敏捷教练的六脉神剑（下）">敏捷教练第08课-技巧-敏捷教练的六脉神剑（下）</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC09%E8%AF%BE-%E6%8A%80%E5%B7%A7-%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%9A%84%E6%8F%90%E5%8D%87%E4%B8%89%E5%BC%8F/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第09课-技巧-敏捷教练的提升三式">敏捷教练第09课-技巧-敏捷教练的提升三式</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC10%E8%AF%BE-%E6%8A%80%E5%B7%A7-%E6%8C%81%E7%BB%AD%E6%94%B9%E5%96%84%E5%92%8C%E7%B3%BB%E7%BB%9F%E6%80%9D%E8%80%83%E6%96%B9%E6%B3%95/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第10课-技巧-持续改善和系统思考方法">敏捷教练第10课-技巧-持续改善和系统思考方法</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC11%E8%AF%BE-%E5%AE%9E%E6%88%98-%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E5%AE%9E%E6%88%98%E5%91%A8%E6%9C%9FV%E5%BD%A2%E5%85%AD%E6%AD%A5%E6%B3%95/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第11课-实战-敏捷教练实战周期V形六步法">敏捷教练第11课-实战-敏捷教练实战周期V形六步法</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC06%E8%AF%BE-%E6%8A%80%E5%B7%A7-%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%9A%84%E5%9B%9B%E7%A7%8D%E5%BF%83%E6%B3%95/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第06课-技巧-敏捷教练的四种心法">敏捷教练第06课-技巧-敏捷教练的四种心法</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 Scrum "
           href="/2022/04/12/%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%AC%AC07%E8%AF%BE-%E6%8A%80%E5%B7%A7-%E6%95%8F%E6%8D%B7%E6%95%99%E7%BB%83%E7%9A%84%E5%85%AD%E8%84%89%E7%A5%9E%E5%89%91%EF%BC%88%E4%B8%8A%EF%BC%89/"
           data-tag="Scrum"
           data-author="" >
            <span class="post-title" title="敏捷教练第07课-技巧-敏捷教练的六脉神剑（上）">敏捷教练第07课-技巧-敏捷教练的六脉神剑（上）</span>
            <span class="post-date" title="2022-04-12 00:00:00">2022/04/12</span>
        </a>
        
        <a  class="全部文章 公有云 "
           href="/2022/03/08/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8ECS%E9%80%89%E8%B4%AD%E6%8C%87%E5%8D%97%E5%8F%8A%E7%9C%81%E9%92%B1%E6%B3%95%E5%AE%9D/"
           data-tag="公有云"
           data-author="" >
            <span class="post-title" title="云服务器ECS选购指南及省钱法宝">云服务器ECS选购指南及省钱法宝</span>
            <span class="post-date" title="2022-03-08 00:00:00">2022/03/08</span>
        </a>
        
        <a  class="全部文章 SRE "
           href="/2022/03/08/%E9%98%BF%E9%87%8C%E4%BA%91%E5%BC%B9%E6%80%A7%E8%AE%A1%E7%AE%97%E7%A0%94%E5%8F%91%E5%9B%A2%E9%98%9F%E5%A6%82%E4%BD%95%E4%BB%8E0%E5%88%B01%E8%87%AA%E5%BB%BASRE%E4%BD%93%E7%B3%BB/"
           data-tag="SRE"
           data-author="" >
            <span class="post-title" title="阿里云弹性计算研发团队如何从0到1自建SRE体系">阿里云弹性计算研发团队如何从0到1自建SRE体系</span>
            <span class="post-date" title="2022-03-08 00:00:00">2022/03/08</span>
        </a>
        
        <a  class="全部文章 SRE "
           href="/2022/03/08/%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E6%96%B0%E6%A8%A1%E5%BC%8F/"
           data-tag="SRE"
           data-author="" >
            <span class="post-title" title="云上资源自动化部署新模式">云上资源自动化部署新模式</span>
            <span class="post-date" title="2022-03-08 00:00:00">2022/03/08</span>
        </a>
        
        <a  class="全部文章 我假装讲-你假装看 "
           href="/2021/07/22/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%8B%96%E5%9E%AE%E4%B8%AD%E5%B0%8F%E5%85%AC%E5%8F%B8%E6%8A%80%E6%9C%AF%E5%9B%A2%E9%98%9F%E7%9A%8410%E5%AE%97%E7%BD%AA/"
           data-tag="我假装讲-你假装看"
           data-author="" >
            <span class="post-title" title="常见的拖垮中小公司技术团队的10宗罪">常见的拖垮中小公司技术团队的10宗罪</span>
            <span class="post-date" title="2021-07-22 00:00:00">2021/07/22</span>
        </a>
        
        <a  class="全部文章 架构 "
           href="/2021/07/22/%E6%88%91%E5%81%9A%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8E%9F%E5%88%99/"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="我做系统架构的一些原则">我做系统架构的一些原则</span>
            <span class="post-date" title="2021-07-22 00:00:00">2021/07/22</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/05/31/cotainer-init/"
           data-tag="Kubernetes"
           data-author="" >
            <span class="post-title" title="开启shareProcessNamespace后容器异常">开启shareProcessNamespace后容器异常</span>
            <span class="post-date" title="2021-05-31 00:00:00">2021/05/31</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/05/31/docker-shell-signal/"
           data-tag="Kubernetes"
           data-author="" >
            <span class="post-title" title="k8s中shell脚本启动如何传递信号">k8s中shell脚本启动如何传递信号</span>
            <span class="post-date" title="2021-05-31 00:00:00">2021/05/31</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/05/31/enforce-audit-policy-in-k8s/"
           data-tag="Kubernetes"
           data-author="" >
            <span class="post-title" title="在Kubernetes中实施审计策略">在Kubernetes中实施审计策略</span>
            <span class="post-date" title="2021-05-31 00:00:00">2021/05/31</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/05/26/Cilium-Network-Overview/"
           data-tag="Cilium"
           data-author="" >
            <span class="post-title" title="Cilium网络概述">Cilium网络概述</span>
            <span class="post-date" title="2021-05-26 00:00:00">2021/05/26</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/05/19/generating-yaml-for-k8s/"
           data-tag="Kubernetes"
           data-author="" >
            <span class="post-title" title="快速生成k8s的yaml配置的4种方法">快速生成k8s的yaml配置的4种方法</span>
            <span class="post-date" title="2021-05-19 00:00:00">2021/05/19</span>
        </a>
        
        <a  class="全部文章 日志 "
           href="/2021/04/28/fklek-to-k8s-log/"
           data-tag="日志"
           data-author="" >
            <span class="post-title" title="使用fklek搭建Kubernetes日志收集工具栈">使用fklek搭建Kubernetes日志收集工具栈</span>
            <span class="post-date" title="2021-04-28 00:00:00">2021/04/28</span>
        </a>
        
        <a  class="全部文章 我假装讲-你假装看 "
           href="/2021/04/27/%E5%8F%AA%E6%9C%89%E9%BB%91%E8%AF%9D%E6%89%8D%E8%83%BD%E6%8B%AF%E6%95%91%E4%BA%92%E8%81%94%E7%BD%91%E4%BA%BA/"
           data-tag="我假装讲-你假装看"
           data-author="" >
            <span class="post-title" title="只有黑话才能拯救互联网人">只有黑话才能拯救互联网人</span>
            <span class="post-date" title="2021-04-27 00:00:00">2021/04/27</span>
        </a>
        
        <a  class="全部文章 我假装讲-你假装看 "
           href="/2021/04/27/%E6%BC%AB%E7%94%BB%E4%B8%80%E4%B8%AANB%E4%BA%92%E8%81%94%E7%BD%91%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%8A%E7%BA%BF%E8%BF%87%E7%A8%8B/"
           data-tag="我假装讲-你假装看"
           data-author="" >
            <span class="post-title" title="漫画一个NB互联网项目的上线过程">漫画一个NB互联网项目的上线过程</span>
            <span class="post-date" title="2021-04-27 00:00:00">2021/04/27</span>
        </a>
        
        <a  class="全部文章 消息系统 "
           href="/2021/04/24/comparing-pulsar-and-kafka-from-a-ctos-point-of-view/"
           data-tag="Pulsar"
           data-author="" >
            <span class="post-title" title="Pulsar vs Kafka，CTO 如何抉择">Pulsar vs Kafka，CTO 如何抉择</span>
            <span class="post-date" title="2021-04-24 00:00:00">2021/04/24</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/04/21/kubernetes-best-practices-in-production/"
           data-tag="Kubernetes"
           data-author="" >
            <span class="post-title" title="生产环境中的Kubernetes最佳实践">生产环境中的Kubernetes最佳实践</span>
            <span class="post-date" title="2021-04-21 00:00:00">2021/04/21</span>
        </a>
        
        <a  class="全部文章 职业发展 "
           href="/2021/04/19/jishuchengzhang/"
           data-tag="职业发展"
           data-author="" >
            <span class="post-title" title="你的技术成长战略是什么">你的技术成长战略是什么</span>
            <span class="post-date" title="2021-04-19 00:00:00">2021/04/19</span>
        </a>
        
        <a  class="全部文章 containerd "
           href="/2021/04/12/nerdctl-to-containerd/"
           data-tag="containerd"
           data-author="" >
            <span class="post-title" title="使用nerdctl玩转containerd">使用nerdctl玩转containerd</span>
            <span class="post-date" title="2021-04-12 00:00:00">2021/04/12</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/04/09/Kubernetes-network/"
           data-tag="Kubernetes"
           data-author="" >
            <span class="post-title" title="Kubernetes网络和云厂商实践浅析">Kubernetes网络和云厂商实践浅析</span>
            <span class="post-date" title="2021-04-09 00:00:00">2021/04/09</span>
        </a>
        
        <a  class="全部文章 Ingress "
           href="/2021/04/08/Technical-selection-of-Kubernetes-Ingress-controller/"
           data-tag="Ingress"
           data-author="" >
            <span class="post-title" title="Kubernetes Ingress 控制器的技术选型技巧">Kubernetes Ingress 控制器的技术选型技巧</span>
            <span class="post-date" title="2021-04-08 00:00:00">2021/04/08</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/04/08/Kubernetes-remen/"
           data-tag="Kubernetes"
           data-author="" >
            <span class="post-title" title="Kubernetes入门-进阶实战">Kubernetes入门-进阶实战</span>
            <span class="post-date" title="2021-04-08 00:00:00">2021/04/08</span>
        </a>
        
        <a  class="全部文章 Kubernetes "
           href="/2021/03/24/Flannel-Calico/"
           data-tag="flannel"
           data-author="" >
            <span class="post-title" title="Flannel-Calico怎么选择">Flannel-Calico怎么选择</span>
            <span class="post-date" title="2021-03-24 00:00:00">2021/03/24</span>
        </a>
        
        <a  class="全部文章 nginx "
           href="/2021/03/15/nginx-knowledge-graph/"
           data-tag="nginx"
           data-author="" >
            <span class="post-title" title="nginx核心知识100讲知识图谱">nginx核心知识100讲知识图谱</span>
            <span class="post-date" title="2021-03-15 00:00:00">2021/03/15</span>
        </a>
        
        <a  class="全部文章 优化 "
           href="/2021/03/15/performance-optimize-your-program/"
           data-tag="性能"
           data-author="" >
            <span class="post-title" title="性能之癫-优化你的程序">性能之癫-优化你的程序</span>
            <span class="post-date" title="2021-03-15 00:00:00">2021/03/15</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Kubernetes-remen" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Kubernetes入门-进阶实战</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="Kubernetes">Kubernetes</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">Kubernetes</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2021-04-08 17:59:59'>2021-04-08 00:00</time>
        
    </div>
    <div class="article-meta">
        
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kubernetes-%E5%85%A5%E9%97%A8-amp-%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98"><span class="toc-text">Kubernetes 入门&amp;进阶实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#I-K8S-%E6%A6%82%E8%A7%88"><span class="toc-text">I. K8S 概览</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-K8S-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">1.1 K8S 是什么？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF-K8S"><span class="toc-text">1.2 为什么是 K8S?</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-3-K8S-%E6%80%8E%E4%B9%88%E5%81%9A%EF%BC%9F"><span class="toc-text">1.3 K8S 怎么做？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#II-K8S-%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5"><span class="toc-text">II. K8S 重要概念</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-Pod-%E5%AE%9E%E4%BE%8B"><span class="toc-text">2.1 Pod 实例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-Container-%E5%AE%B9%E5%99%A8"><span class="toc-text">2.3 Container 容器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-4-Deployment-%E5%92%8C-ReplicaSet%EF%BC%88%E7%AE%80%E7%A7%B0-RS%EF%BC%89"><span class="toc-text">2.4 Deployment 和 ReplicaSet（简称 RS）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-Service-%E5%92%8C-Ingress"><span class="toc-text">2.5 Service 和 Ingress</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-6-namespace-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-text">2.6 namespace 命名空间</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-7-%E5%85%B6%E4%BB%96"><span class="toc-text">2.7 其他</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#III-%E9%85%8D%E7%BD%AE-kubectl"><span class="toc-text">III. 配置 kubectl</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-%E4%BB%80%E4%B9%88%E6%98%AF-kubectl%EF%BC%9F"><span class="toc-text">3.1 什么是 kubectl？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-%E6%80%8E%E4%B9%88%E9%85%8D%E7%BD%AE-kubectl%EF%BC%9F"><span class="toc-text">1.2 怎么配置 kubectl？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IV-kubectl-%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1"><span class="toc-text">IV. kubectl 部署服务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-%E5%A6%82%E4%BD%95%E9%83%A8%E7%BD%B2-Pod%EF%BC%9F"><span class="toc-text">2.1 如何部署 Pod？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-%E5%A6%82%E4%BD%95%E9%83%A8%E7%BD%B2-Deployment%EF%BC%9F"><span class="toc-text">2.2 如何部署 Deployment？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#V-kubectl-%E6%9F%A5%E7%9C%8B%E3%80%81%E6%9B%B4%E6%96%B0-%E7%BC%96%E8%BE%91%E3%80%81%E5%88%A0%E9%99%A4%E6%9C%8D%E5%8A%A1"><span class="toc-text">V. kubectl 查看、更新&#x2F;编辑、删除服务</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%EF%BC%9F"><span class="toc-text">3.1 如何查看服务？</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RESOURCE-%E6%9C%89-pod%E3%80%81deployment%E3%80%81replicaset-rs"><span class="toc-text">${RESOURCE}有:?pod、deployment、replicaset(rs)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-%E5%A6%82%E4%BD%95%E6%9B%B4%E6%96%B0-%E7%BC%96%E8%BE%91%E6%9C%8D%E5%8A%A1%EF%BC%9F"><span class="toc-text">3.2 如何更新&#x2F;编辑服务？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E6%9C%8D%E5%8A%A1%EF%BC%9F"><span class="toc-text">3.3 如何删除服务？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VI-kubectl-%E6%8E%92%E6%9F%A5%E6%9C%8D%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-text">VI. kubectl 排查服务问题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-K8S-%E4%B8%8A%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1%E5%A4%B1%E8%B4%A5%E4%BA%86%E6%80%8E%E4%B9%88%E6%8E%92%E6%9F%A5%EF%BC%9F"><span class="toc-text">4.1 K8S 上部署服务失败了怎么排查？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2-K8S-%E4%B8%8A%E9%83%A8%E7%BD%B2%E7%9A%84%E6%9C%8D%E5%8A%A1%E4%B8%8D%E6%AD%A3%E5%B8%B8%E6%80%8E%E4%B9%88%E6%8E%92%E6%9F%A5%EF%BC%9F"><span class="toc-text">4.2 K8S 上部署的服务不正常怎么排查？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%90%8E%E9%9D%A2"><span class="toc-text">写在后面</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<h3 id="Kubernetes-入门-amp-进阶实战"><a href="#Kubernetes-入门-amp-进阶实战" class="headerlink" title="Kubernetes 入门&amp;进阶实战"></a>Kubernetes 入门&amp;进阶实战</h3></blockquote>
<blockquote>
<p>作者：oonamao毛江云，腾讯 CSIG 应用开发工程师</p>
<p>本文组织方式：</p>
<p>1.?K8S?是什么，即作用和目的。涉及?K8S?架构的整理，Master?和?Node?之间的关系，以及?K8S?几个重要的组件：API?Server、Scheduler、Controller、etcd?等。<br>2.?K8S?的重要概念，即?K8S?的?API?对象，也就是常常听到的?Pod、Deployment、Service?等。<br>3.?如何配置?kubectl，介绍kubectl工具和配置办法。<br>4.?如何用kubectl?部署服务。<br>5.?如何用kubectl?查看、更新/编辑、删除服务。<br>6.?如何用kubectl?排查部署在K8S集群上的服务出现的问题</p>
<h3 id="I-K8S-概览"><a href="#I-K8S-概览" class="headerlink" title="I. K8S 概览"></a>I. K8S 概览</h3><h5 id="1-1-K8S-是什么？"><a href="#1-1-K8S-是什么？" class="headerlink" title="1.1 K8S 是什么？"></a>1.1 K8S 是什么？</h5><p>K8S 是Kubernetes的全称，官方称其是：</p>
<blockquote>
<p>Kubernetes is an open source system for managing containerized applications across multiple hosts. It provides basic mechanisms for deployment, maintenance, and scaling of applications.</p>
<p>用于自动部署、扩展和管理“容器化（containerized）应用程序”的开源系统。</p>
</blockquote>
<p>翻译成大白话就是：“<strong>K8 是 S 负责自动化运维管理多个 Docker 程序的集群</strong>”。那么问题来了：Docker 运行可方便了，为什么要用 K8S，它有什么优势？</p>
<p>插一句题外话：</p>
<ul>
<li><p>为什么 Kubernetes 要叫 Kubernetes 呢？维基百科已经交代了（老美对星际是真的痴迷）：</p>
<blockquote>
<p>Kubernetes（在希腊语意为“舵手”或“驾驶员”）由 Joe Beda、Brendan Burns 和 Craig McLuckie 创立，并由其他谷歌工程师，包括 Brian Grant 和 Tim Hockin 等进行加盟创作，并由谷歌在 2014 年首次对外宣布 。该系统的开发和设计都深受谷歌的 Borg 系统的影响，其许多顶级贡献者之前也是 Borg 系统的开发者。在谷歌内部，Kubernetes 的原始代号曾经是Seven，即星际迷航中的 Borg（博格人）。Kubernetes 标识中舵轮有七个轮辐就是对该项目代号的致意。</p>
</blockquote>
</li>
<li><p>  为什么 Kubernetes 的缩写是 K8S 呢？我个人赞同Why Kubernetes is Abbreviated k8s中说的观点“嘛，写全称也太累了吧，不如整个缩写”。其实只保留首位字符，用具体数字来替代省略的字符个数的做法，还是比较常见的。</p>
</li>
</ul>
<h5 id="1-2-为什么是-K8S"><a href="#1-2-为什么是-K8S" class="headerlink" title="1.2 为什么是 K8S?"></a>1.2 为什么是 K8S?</h5><p>试想下传统的后端部署办法：把程序包（包括可执行二进制文件、配置文件等）放到服务器上，接着运行启动脚本把程序跑起来，同时启动守护脚本定期检查程序运行状态、必要的话重新拉起程序。</p>
<p>有问题吗？显然有！最大的一个问题在于：**如果服务的请求量上来，已部署的服务响应不过来怎么办？**传统的做法往往是，如果请求量、内存、CPU 超过阈值做了告警，运维马上再加几台服务器，部署好服务之后，接入负载均衡来分担已有服务的压力。</p>
<p>问题出现了：从监控告警到部署服务，中间需要人力介入！那么，<strong>有没有办法自动完成服务的部署、更新、卸载和扩容、缩容呢？</strong></p>
<p><strong>这，就是 K8S 要做的事情：自动化运维管理 Docker（容器化）程序</strong>。</p>
<h5 id="1-3-K8S-怎么做？"><a href="#1-3-K8S-怎么做？" class="headerlink" title="1.3 K8S 怎么做？"></a>1.3 K8S 怎么做？</h5><p>我们已经知道了 K8S 的核心功能：自动化运维管理多个容器化程序。那么 K8S 怎么做到的呢？这里，我们从宏观架构上来学习 K8S 的设计思想。首先看下图，图片来自文章Components of Kubernetes Architecture：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/ca2fc2b718b3e342.jpeg?x-oss-process=style/bb"></p>
<p>K8S 是属于<strong>主从设备模型（Master-Slave 架构）</strong>，即有 Master 节点负责核心的调度、管理和运维，Slave 节点则在执行用户的程序。但是在 K8S 中，主节点一般被称为<strong>Master Node 或者 Head Node</strong>（本文采用 Master Node 称呼方式），而从节点则被称为<strong>Worker Node 或者 Node</strong>（本文采用 Worker Node 称呼方式）。</p>
<p>要注意一点：Master Node 和 Worker Node 是分别安装了 K8S 的 Master 和 Woker 组件的实体服务器，每个 Node 都对应了一台实体服务器（虽然 Master Node 可以和其中一个 Worker Node 安装在同一台服务器，但是建议 Master Node 单独部署），<strong>所有 Master Node 和 Worker Node 组成了 K8S 集群</strong>，同一个集群可能存在多个 Master Node 和 Worker Node。</p>
<p>首先来看<strong>Master Node</strong>都有哪些组件：</p>
<ul>
<li><p>  <strong>API Server</strong>。<strong>K8S 的请求入口服务</strong>。API Server 负责接收 K8S 所有请求（来自 UI 界面或者 CLI 命令行工具），然后，API Server 根据用户的具体请求，去通知其他组件干活。</p>
</li>
<li><p>  <strong>Scheduler</strong>。<strong>K8S 所有 Worker Node 的调度器</strong>。当用户要部署服务时，Scheduler 会选择最合适的 Worker Node（服务器）来部署。</p>
</li>
<li><p>  <strong>Controller Manager</strong>。<strong>K8S 所有 Worker Node 的监控器</strong>。Controller Manager 有很多具体的 Controller，在文章Components of Kubernetes Architecture中提到的有 Node Controller、Service Controller、Volume Controller 等。Controller 负责监控和调整在 Worker Node 上部署的服务的状态，比如用户要求 A 服务部署 2 个副本，那么当其中一个服务挂了的时候，Controller 会马上调整，让 Scheduler 再选择一个 Worker Node 重新部署服务。</p>
</li>
<li><p>  <strong>etcd</strong>。<strong>K8S 的存储服务</strong>。etcd 存储了 K8S 的关键配置和用户配置，K8S 中仅 API Server 才具备读写权限，其他组件必须通过 API Server 的接口才能读写数据（见Kubernetes Works Like an Operating System）。</p>
</li>
</ul>
<p>接着来看<strong>Worker Node</strong>的组件，笔者更赞同HOW DO APPLICATIONS RUN ON KUBERNETES文章中提到的组件介绍：</p>
<ul>
<li><p>  <strong>Kubelet</strong>。<strong>Worker Node 的监视器，以及与 Master Node 的通讯器</strong>。Kubelet 是 Master Node 安插在 Worker Node 上的“眼线”，它会定期向 Worker Node 汇报自己 Node 上运行的服务的状态，并接受来自 Master Node 的指示采取调整措施。</p>
</li>
<li><p>  <strong>Kube-Proxy</strong>。<strong>K8S 的网络代理</strong>。私以为称呼为 Network-Proxy 可能更适合？Kube-Proxy 负责 Node 在 K8S 的网络通讯、以及对外部网络流量的负载均衡。</p>
</li>
<li><p>  <strong>Container Runtime</strong>。<strong>Worker Node 的运行环境</strong>。即安装了容器化所需的软件环境确保容器化程序能够跑起来，比如 Docker Engine。大白话就是帮忙装好了 Docker 运行环境。</p>
</li>
<li><p>  <strong>Logging Layer</strong>。<strong>K8S 的监控状态收集器</strong>。私以为称呼为 Monitor 可能更合适？Logging Layer 负责采集 Node 上所有服务的 CPU、内存、磁盘、网络等监控项信息。</p>
</li>
<li><p>  <strong>Add-Ons</strong>。<strong>K8S 管理运维 Worker Node 的插件组件</strong>。有些文章认为 Worker Node 只有三大组件，不包含 Add-On，但笔者认为 K8S 系统提供了 Add-On 机制，让用户可以扩展更多定制化功能，是很不错的亮点。</p>
</li>
</ul>
<p>总结来看，<strong>K8S 的 Master Node 具备：请求入口管理（API Server），Worker Node 调度（Scheduler），监控和自动调节（Controller Manager），以及存储功能（etcd）；而 K8S 的 Worker Node 具备：状态和监控收集（Kubelet），网络和负载均衡（Kube-Proxy）、保障容器化运行环境（Container Runtime）、以及定制化功能（Add-Ons）。</strong></p>
<p>到这里，相信你已经对 K8S 究竟是做什么的，有了大概认识。接下来，再来认识下 K8S 的 Deployment、Pod、Replica Set、Service 等，但凡谈到 K8S，就绕不开这些名词，而这些名词也是最让 K8S 新手们感到头疼、困惑的。</p>
<h3 id="II-K8S-重要概念"><a href="#II-K8S-重要概念" class="headerlink" title="II. K8S 重要概念"></a>II. K8S 重要概念</h3><h5 id="2-1-Pod-实例"><a href="#2-1-Pod-实例" class="headerlink" title="2.1 Pod 实例"></a>2.1 Pod 实例</h5><p>官方对于<strong>Pod</strong>的解释是：</p>
<blockquote>
<p><strong>Pod</strong>是可以在 Kubernetes 中创建和管理的、最小的可部署的计算单元。</p>
</blockquote>
<p>这样的解释还是很难让人明白究竟 Pod 是什么，但是对于 K8S 而言，Pod 可以说是所有对象中最重要的概念了！因此，我们<strong>必须首先清楚地知道“Pod 是什么”</strong>，再去了解其他的对象。</p>
<p>从官方给出的定义，联想下“最小的 xxx 单元”，是不是可以想到本科在学校里学习“进程”的时候，教科书上有一段类似的描述：资源分配的最小单位；还有”线程“的描述是：CPU 调度的最小单位。什么意思呢？<strong>”最小 xx 单位“要么就是事物的衡量标准单位，要么就是资源的闭包、集合</strong>。前者比如长度米、时间秒；后者比如一个”进程“是存储和计算的闭包，一个”线程“是 CPU 资源（包括寄存器、ALU 等）的闭包。</p>
<p>同样的，<strong>Pod 就是 K8S 中一个服务的闭包</strong>。这么说的好像还是有点玄乎，更加云里雾里了。简单来说，<strong>Pod 可以被理解成一群可以共享网络、存储和计算资源的容器化服务的集合</strong>。再打个形象的比喻，在同一个 Pod 里的几个 Docker 服务/程序，好像被部署在同一台机器上，可以通过 localhost 互相访问，并且可以共用 Pod 里的存储资源（这里是指 Docker 可以挂载 Pod 内的数据卷，数据卷的概念，后文会详细讲述，暂时理解为“需要手动 mount 的磁盘”）。笔者总结 Pod 如下图，可以看到：<strong>同一个 Pod 之间的 Container 可以通过 localhost 互相访问，并且可以挂载 Pod 内所有的数据卷；但是不同的 Pod 之间的 Container 不能用 localhost 访问，也不能挂载其他 Pod 的数据卷</strong>。</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/699bc2906b2d2360.jpeg?x-oss-process=style/bb"></p>
<p>对 Pod 有直观的认识之后，接着来看 K8S 中 Pod 究竟长什么样子，具体包括哪些资源？</p>
<p>K8S 中所有的对象都通过 yaml 来表示，笔者从官方网站摘录了一个最简单的 Pod 的 yaml：</p>
<p><code>apiVersion:?v1   kind:?Pod   metadata:   ??name:?memory-demo   ??namespace:?mem-example   spec:   ??containers:   ??-?name:?memory-demo-ctr   ????image:?polinux/stress   ????resources:   ??????limits:   ????????memory:?&quot;200Mi&quot;   ??????requests:   ????????memory:?&quot;100Mi&quot;   ????command:?[&quot;stress&quot;]   ????args:?[&quot;--vm&quot;,?&quot;1&quot;,?&quot;--vm-bytes&quot;,?&quot;150M&quot;,?&quot;--vm-hang&quot;,?&quot;1&quot;]   ????volumeMounts:   ????-?name:?redis-storage   ??????mountPath:?/data/redis   ??volumes:   ??-?name:?redis-storage   ????emptyDir:?&#123;&#125;   </code></p>
<p>看不懂不必慌张，且耐心听下面的解释：</p>
<ul>
<li><p>  <code>apiVersion</code>记录 K8S 的 API Server 版本，现在看到的都是<code>v1</code>，用户不用管。</p>
</li>
<li><p>  <code>kind</code>记录该 yaml 的对象，比如这是一份 Pod 的 yaml 配置文件，那么值内容就是<code>Pod</code>。</p>
</li>
<li><p>  <code>metadata</code>记录了 Pod 自身的元数据，比如这个 Pod 的名字、这个 Pod 属于哪个 namespace（命名空间的概念，后文会详述，暂时理解为“同一个命名空间内的对象互相可见”）。</p>
</li>
<li><p>  <code>spec</code>记录了 Pod 内部所有的资源的详细信息，看懂这个很重要：</p>
</li>
</ul>
<ul>
<li><p>  <code>containers</code>记录了 Pod 内的容器信息，<code>containers</code>包括了：<code>name</code>容器名，<code>image</code>容器的镜像地址，<code>resources</code>容器需要的 CPU、内存、GPU 等资源，<code>command</code>容器的入口命令，<code>args</code>容器的入口参数，<code>volumeMounts</code>容器要挂载的 Pod 数据卷等。可以看到，<strong>上述这些信息都是启动容器的必要和必需的信息</strong>。</p>
</li>
<li><p>  <code>volumes</code>记录了 Pod 内的数据卷信息，后文会详细介绍 Pod 的数据卷。</p>
</li>
</ul>
<p><strong>2.2 Volume 数据卷</strong></p>
<p>K8S 支持很多类型的 volume 数据卷挂载，具体请参见K8S 卷。前文就“如何理解 volume”提到：“<strong>需要手动 mount 的磁盘</strong>”，此外，有一点可以帮助理解：<strong>数据卷 volume 是 Pod 内部的磁盘资源</strong>。</p>
<p>其实，单单就 Volume 来说，不难理解。但是上面还看到了<code>volumeMounts</code>，这俩是什么关系呢？</p>
<p><strong>volume 是 K8S 的对象，对应一个实体的数据卷；而 volumeMounts 只是 container 的挂载点，对应 container 的其中一个参数</strong>。但是，<strong>volumeMounts 依赖于 volume</strong>，只有当 Pod 内有 volume 资源的时候，该 Pod 内部的 container 才可能有 volumeMounts。</p>
<h5 id="2-3-Container-容器"><a href="#2-3-Container-容器" class="headerlink" title="2.3 Container 容器"></a>2.3 Container 容器</h5><p>本文中提到的镜像 Image、容器 Container，都指代了 Pod 下的一个<code>container</code>。关于 K8S 中的容器，在 2.1Pod 章节都已经交代了，这里无非再啰嗦一句：<strong>一个 Pod 内可以有多个容器 container</strong>。</p>
<p>在 Pod 中，容器也有分类，对这个感兴趣的同学欢迎自行阅读更多资料：</p>
<ul>
<li><p>  <strong>标准容器 Application Container</strong>。</p>
</li>
<li><p>  <strong>初始化容器 Init Container</strong>。</p>
</li>
<li><p>  <strong>边车容器 Sidecar Container</strong>。</p>
</li>
<li><p>  <strong>临时容器 Ephemeral Container</strong>。</p>
</li>
</ul>
<p>一般来说，我们部署的大多是<strong>标准容器（ Application Container）</strong>。</p>
<h5 id="2-4-Deployment-和-ReplicaSet（简称-RS）"><a href="#2-4-Deployment-和-ReplicaSet（简称-RS）" class="headerlink" title="2.4 Deployment 和 ReplicaSet（简称 RS）"></a>2.4 Deployment 和 ReplicaSet（简称 RS）</h5><p>除了 Pod 之外，K8S 中最常听到的另一个对象就是 Deployment 了。那么，什么是 Deployment 呢？官方给出了一个要命的解释：</p>
<blockquote>
<p>一个 <em>Deployment</em> 控制器为 Pods 和 ReplicaSets 提供声明式的更新能力。</p>
<p>你负责描述 Deployment 中的 _目标状态_，而 Deployment 控制器以受控速率更改实际状态， 使其变为期望状态。你可以定义 Deployment 以创建新的 ReplicaSet，或删除现有 Deployment，并通过新的 Deployment 收养其资源。</p>
</blockquote>
<p>翻译一下：<strong>Deployment 的作用是管理和控制 Pod 和 ReplicaSet，管控它们运行在用户期望的状态中</strong>。哎，打个形象的比喻，** Deployment 就是包工头 **，主要负责监督底下的工人 Pod 干活，确保每时每刻有用户要求数量的 Pod 在工作。如果一旦发现某个工人 Pod 不行了，就赶紧新拉一个 Pod 过来替换它。</p>
<p>新的问题又来了：那什么是 ReplicaSets 呢？</p>
<blockquote>
<p>ReplicaSet 的目的是维护一组在任何时候都处于运行状态的 Pod 副本的稳定集合。因此，它通常用来保证给定数量的、完全相同的 Pod 的可用性。</p>
</blockquote>
<p>再来翻译下：ReplicaSet 的作用就是管理和控制 Pod，管控他们好好干活。但是，ReplicaSet 受控于 Deployment。形象来说，<strong>ReplicaSet 就是总包工头手下的小包工头</strong>。</p>
<p>笔者总结得到下面这幅图，希望能帮助理解：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/84b954d509a70147.jpeg?x-oss-process=style/bb"></p>
<p>新的问题又来了：<strong>如果都是为了管控 Pod 好好干活，为什么要设置 Deployment 和 ReplicaSet 两个层级呢，直接让 Deployment 来管理不可以吗？</strong></p>
<p>回答：不清楚，但是私以为是因为先有 ReplicaSet，但是使用中发现 ReplicaSet 不够满足要求，于是又整了一个 Deployment（<strong>有清楚 Deployment 和 ReplicaSet 联系和区别的小伙伴欢迎留言啊</strong>）。</p>
<p>但是，从 K8S 使用者角度来看，用户会直接操作 Deployment 部署服务，而当 Deployment 被部署的时候，K8S 会自动生成要求的 ReplicaSet 和 Pod。在K8S 官方文档中也指出用户只需要关心 Deployment 而不操心 ReplicaSet：</p>
<blockquote>
<p>This actually means that you may never need to manipulate ReplicaSet objects: use a Deployment instead, and define your application in the spec section.</p>
<p>这实际上意味着您可能永远不需要操作 ReplicaSet 对象：直接使用 Deployments 并在规范部分定义应用程序。</p>
</blockquote>
<p>补充说明：在 K8S 中还有一个对象 — <strong>ReplicationController（简称 RC）</strong>，官方文档对它的定义是：</p>
<blockquote>
<p><em>ReplicationController</em> 确保在任何时候都有特定数量的 Pod 副本处于运行状态。换句话说，ReplicationController 确保一个 Pod 或一组同类的 Pod 总是可用的。</p>
</blockquote>
<p>怎么样，和 ReplicaSet 是不是很相近？在Deployments, ReplicaSets, and pods教程中说“ReplicationController 是 ReplicaSet 的前身”，官方也推荐用 Deployment 取代 ReplicationController 来部署服务。</p>
<h5 id="2-5-Service-和-Ingress"><a href="#2-5-Service-和-Ingress" class="headerlink" title="2.5 Service 和 Ingress"></a>2.5 Service 和 Ingress</h5><p>吐槽下 K8S 的概念/对象/资源是真的多啊！<strong>前文介绍的 Deployment、ReplicationController 和 ReplicaSet 主要管控 Pod 程序服务；那么，Service 和 Ingress 则负责管控 Pod 网络服务</strong>。</p>
<p>我们先来看看官方文档中 Service 的定义：</p>
<blockquote>
<p>将运行在一组 Pods 上的应用程序公开为网络服务的抽象方法。</p>
<p>使用 Kubernetes，您无需修改应用程序即可使用不熟悉的服务发现机制。Kubernetes 为 Pods 提供自己的 IP 地址，并为一组 Pod 提供相同的 DNS 名， 并且可以在它们之间进行负载均衡。</p>
</blockquote>
<p>翻译下：K8S 中的服务（Service）并不是我们常说的“服务”的含义，而更像是网关层，是若干个 Pod 的流量入口、流量均衡器。</p>
<p>那么，<strong>为什么要 Service 呢</strong>？</p>
<p>私以为在这一点上，官方文档讲解地非常清楚：</p>
<blockquote>
<p>Kubernetes Pod 是有生命周期的。它们可以被创建，而且销毁之后不会再启动。如果您使用 Deployment 来运行您的应用程序，则它可以动态创建和销毁 Pod。</p>
<p>每个 Pod 都有自己的 IP 地址，但是在 Deployment 中，在同一时刻运行的 Pod 集合可能与稍后运行该应用程序的 Pod 集合不同。</p>
<p>这导致了一个问题：如果一组 Pod（称为“后端”）为群集内的其他 Pod（称为“前端”）提供功能， 那么前端如何找出并跟踪要连接的 IP 地址，以便前端可以使用工作量的后端部分？</p>
</blockquote>
<p>补充说明：K8S 集群的网络管理和拓扑也有特别的设计，以后会专门出一章节来详细介绍 K8S 中的网络。这里需要清楚一点：K8S 集群内的每一个 Pod 都有自己的 IP（是不是很类似一个 Pod 就是一台服务器，然而事实上是多个 Pod 存在于一台服务器上，只不过是 K8S 做了网络隔离），在 K8S 集群内部还有 DNS 等网络服务（一个 K8S 集群就如同管理了多区域的服务器，可以做复杂的网络拓扑）。</p>
<p>此外，笔者推荐k8s 外网如何访问业务应用对于 Service 的介绍，不过对于新手而言，推荐阅读前半部分对于 service 的介绍即可，后半部分就太复杂了。我这里做了简单的总结：</p>
<p><strong>Service 是 K8S 服务的核心，屏蔽了服务细节，统一对外暴露服务接口，真正做到了“微服务”</strong>。举个例子，我们的一个服务 A，部署了 3 个备份，也就是 3 个 Pod；对于用户来说，只需要关注一个 Service 的入口就可以，而不需要操心究竟应该请求哪一个 Pod。优势非常明显：<strong>一方面外部用户不需要感知因为 Pod 上服务的意外崩溃、K8S 重新拉起 Pod 而造成的 IP 变更，外部用户也不需要感知因升级、变更服务带来的 Pod 替换而造成的 IP 变化，另一方面，Service 还可以做流量负载均衡</strong>。</p>
<p>但是，Service 主要负责 K8S 集群内部的网络拓扑。那么集群外部怎么访问集群内部呢？这个时候就需要 Ingress 了，官方文档中的解释是：</p>
<blockquote>
<p>Ingress 是对集群中服务的外部访问进行管理的 API 对象，典型的访问方式是 HTTP。</p>
<p>Ingress 可以提供负载均衡、SSL 终结和基于名称的虚拟托管。</p>
</blockquote>
<p>翻译一下：Ingress 是整个 K8S 集群的接入层，复杂集群内外通讯。</p>
<p>最后，笔者把 Ingress 和 Service 的关系绘制网络拓扑关系图如下，希望对理解这两个概念有所帮助：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/6d5aba4f055deac4.jpeg?x-oss-process=style/bb"></p>
<h5 id="2-6-namespace-命名空间"><a href="#2-6-namespace-命名空间" class="headerlink" title="2.6 namespace 命名空间"></a>2.6 namespace 命名空间</h5><p>和前文介绍的所有的概念都不一样，namespace 跟 Pod 没有直接关系，而是 K8S 另一个维度的对象。或者说，前文提到的概念都是为了服务 Pod 的，而 namespace 则是为了服务整个 K8S 集群的。</p>
<p>那么，namespace 是什么呢？</p>
<p>上官方文档定义：</p>
<blockquote>
<p>Kubernetes 支持多个虚拟集群，它们底层依赖于同一个物理集群。这些虚拟集群被称为名字空间。</p>
</blockquote>
<p>翻译一下：<strong>namespace 是为了把一个 K8S 集群划分为若干个资源不可共享的虚拟集群而诞生的</strong>。</p>
<p>也就是说，<strong>可以通过在 K8S 集群内创建 namespace 来分隔资源和对象</strong>。比如我有 2 个业务 A 和 B，那么我可以创建 ns-a 和 ns-b 分别部署业务 A 和 B 的服务，如在 ns-a 中部署了一个 deployment，名字是 hello，返回用户的是“hello a”；在 ns-b 中也部署了一个 deployment，名字恰巧也是 hello，返回用户的是“hello b”（要知道，在同一个 namespace 下 deployment 不能同名；但是不同 namespace 之间没有影响）。前文提到的所有对象，都是在 namespace 下的；当然，也有一些对象是不隶属于 namespace 的，而是在 K8S 集群内全局可见的，官方文档提到的可以通过命令来查看，具体命令的使用办法，笔者会出后续的实战文章来介绍，先贴下命令：</p>
<p>`#?位于名字空间中的资源<br>kubectl?api-resources?–namespaced=true  </p>
<p>#?不在名字空间中的资源<br>kubectl?api-resources?–namespaced=false<br>`</p>
<p>不在 namespace 下的对象有：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/ff89644c91845045.jpeg?x-oss-process=style/bb"></p>
<p>在 namespace 下的对象有（部分）：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/a552642c6e79015d.jpeg?x-oss-process=style/bb"></p>
<h5 id="2-7-其他"><a href="#2-7-其他" class="headerlink" title="2.7 其他"></a>2.7 其他</h5><p>K8S 的对象实在太多了，2.1-2.6 介绍的是在实际使用 K8S 部署服务最常见的。其他的还有 Job、CronJob 等等，在对 K8S 有了比较清楚的认知之后，再去学习更多的 K8S 对象，不是难事。</p>
<h3 id="III-配置-kubectl"><a href="#III-配置-kubectl" class="headerlink" title="III. 配置 kubectl"></a>III. 配置 kubectl</h3><h5 id="3-1-什么是-kubectl？"><a href="#3-1-什么是-kubectl？" class="headerlink" title="3.1 什么是 kubectl？"></a>3.1 什么是 kubectl？</h5><p>官方文档中介绍 kubectl 是：</p>
<blockquote>
<p>Kubectl 是一个命令行接口，用于对 Kubernetes 集群运行命令。Kubectl 的配置文件在$HOME/.kube 目录。我们可以通过设置 KUBECONFIG 环境变量或设置命令参数–kubeconfig 来指定其他位置的 kubeconfig 文件。</p>
</blockquote>
<p>也就是说，可以通过 kubectl 来操作 K8S 集群，基本语法：</p>
<blockquote>
<p>使用以下语法 <code>kubectl</code> 从终端窗口运行命令：</p>
<p><code>kubectl?[command]?[TYPE]?[NAME]?[flags]   </code></p>
<p>其中 <code>command</code>、<code>TYPE</code>、<code>NAME</code> 和 <code>flags</code> 分别是：</p>
<ul>
<li><p>  <code>command</code>：指定要对一个或多个资源执行的操作，例如 <code>create</code>、<code>get</code>、<code>describe</code>、<code>delete</code>。</p>
</li>
<li><p>  <code>TYPE</code>：指定资源类型。资源类型不区分大小写，可以指定单数、复数或缩写形式。例如，以下命令输出相同的结果:</p>
</li>
</ul>
<p><code>```shell   kubectl?get?pod?pod1   kubectl?get?pods?pod1   kubectl?get?po?pod1  </code></p>
<p>``<br>-?<code>NAME</code>：指定资源的名称。名称区分大小写。如果省略名称，则显示所有资源的详细信息?<code>kubectl get pods</code>。  </p>
<p>在对多个资源执行操作时，您可以按类型和名称指定每个资源，或指定一个或多个文件：  </p>
<p>-?要按类型和名称指定资源：<br>??-?要对所有类型相同的资源进行分组，请执行以下操作：<code>TYPE1 name1 name2 name&lt;#&gt;</code>。<br>?例子：<code>kubectl get pod example-pod1 example-pod2</code><br>??-?分别指定多个资源类型：<code>TYPE1/name1 TYPE1/name2 TYPE2/name3 TYPE&lt;#&gt;/name&lt;#&gt;</code>。<br>?例子：<code>kubectl get pod/example-pod1 replicationcontroller/example-rc1</code><br>-?用一个或多个文件指定资源：<code>-f file1 -f file2 -f file&lt;#&gt;</code><br>??-?<a href="#general-config-tips">使用?YAML?而不是?JSON</a>?因为 YAML 更容易使用，特别是用于配置文件时。<br>?例子：<code>kubectl get -f ./pod.yaml</code><br>-?<code>flags</code>:?指定可选的参数。例如，可以使用?<code>-s</code>?或?<code>-server</code>?参数指定 Kubernetes API 服务器的地址和端口。<br>``</p>
</blockquote>
<p>就如何使用 kubectl 而言，官方文档已经说得非常清楚。不过对于新手而言，还是需要解释几句：</p>
<ol>
<li><p> kubectl 是 K8S 的命令行工具，并不需要 kubectl 安装在 K8S 集群的任何 Node 上，但是，需要确保安装 kubectl 的机器和 K8S 的集群能够进行网络互通。</p>
</li>
<li><p> kubectl 是通过本地的配置文件来连接到 K8S 集群的，默认保存在$HOME/.kube 目录下；也可以通过 KUBECONFIG 环境变量或设置命令参数–kubeconfig 来指定其他位置的 kubeconfig 文件【官方文档】。</p>
</li>
</ol>
<p>接下来，一起看看怎么使用 kubectl 吧，切身感受下 kubectl 的使用。</p>
<p>请注意，如何安装 kubectl 的办法有许多非常明确的教程，比如《安装并配置 kubectl》，本文不再赘述。</p>
<h5 id="1-2-怎么配置-kubectl？"><a href="#1-2-怎么配置-kubectl？" class="headerlink" title="1.2 怎么配置 kubectl？"></a>1.2 怎么配置 kubectl？</h5><p><strong>第一步，必须准备好要连接/使用的 K8S 的配置文件</strong>，笔者给出一份杜撰的配置：</p>
<p><code>apiVersion:?v1   clusters:   -?cluster:   ????certificate-authority-data:?thisisfakecertifcateauthoritydata00000000000   ????server:?   ??name:?cls-dev   contexts:   -?context:   ????cluster:?cls-dev   ????user:?kubernetes-admin   ??name:?kubernetes-admin@test   current-context:?kubernetes-admin@test   kind:?Config   preferences:?&#123;&#125;   users:   -?name:?kubernetes-admin   ??user:   ????token:?thisisfaketoken00000   </code></p>
<p>解读如下：</p>
<ul>
<li>  <code>clusters</code>记录了 clusters（一个或多个 K8S 集群）信息：</li>
</ul>
<ul>
<li><p>  <code>name</code>是这个 cluster（K8S 集群）的名称代号</p>
</li>
<li><p>  <code>server</code>是这个 cluster（K8S 集群）的访问方式，一般为 IP+PORT</p>
</li>
<li><p>  <code>certificate-authority-data</code>是证书数据，只有当 cluster（K8S 集群）的连接方式是 https 时，为了安全起见需要证书数据</p>
</li>
</ul>
<ul>
<li>  <code>users</code>记录了访问 cluster（K8S 集群）的账号信息：</li>
</ul>
<ul>
<li><p>  <code>name</code>是用户账号的名称代号</p>
</li>
<li><p>  <code>user/token</code>是用户的 token 认证方式，token 不是用户认证的唯一方式，其他还有账号+密码等。</p>
</li>
</ul>
<ul>
<li>  <code>contexts</code>是上下文信息，包括了 cluster（K8S 集群）和访问 cluster（K8S 集群）的用户账号等信息：</li>
</ul>
<ul>
<li><p>  <code>name</code>是这个上下文的名称代号</p>
</li>
<li><p>  <code>cluster</code>是 cluster（K8S 集群）的名称代号</p>
</li>
<li><p>  <code>user</code>是访问 cluster（K8S 集群）的用户账号代号</p>
</li>
</ul>
<ul>
<li><p>  <code>current-context</code>记录当前 kubectl 默认使用的上下文信息</p>
</li>
<li><p>  <code>kind</code>和<code>apiVersion</code>都是固定值，用户不需要关心</p>
</li>
<li><p>  <code>preferences</code>则是配置文件的其他设置信息，笔者没有使用过，暂时不提。</p>
</li>
</ul>
<p><strong>第二步，给 kubectl 配置上配置文件</strong>。</p>
<ol>
<li><p> <strong><code>--kubeconfig</code>参数</strong>。第一种办法是每次执行 kubectl 的时候，都带上<code>--kubeconfig=$&#123;CONFIG_PATH&#125;</code>。给一点温馨小提示：每次都带这么一长串的字符非常麻烦，可以用 alias 别名来简化码字量，比如<code>alias k=kubectl --kubeconfig=$&#123;CONFIG_PATH&#125;</code>。</p>
</li>
<li><p> <strong><code>KUBECONFIG</code>环境变量</strong>。第二种做法是使用环境变量<code>KUBECONFIG</code>把所有配置文件都记录下来，即<code>export KUBECONFIG=$KUBECONFIG:$&#123;CONFIG_PATH&#125;</code>。接下来就可以放心执行 kubectl 命令了。</p>
</li>
<li><p> <strong>$HOME/.kube/config 配置文件</strong>。第三种做法是把配置文件的内容放到$HOME/.kube/config 内。具体做法为：</p>
</li>
</ol>
<ol>
<li><p> 如果$HOME/.kube/config 不存在，那么<code>cp $&#123;CONFIG_PATH&#125; $HOME/.kube/config</code>即可；</p>
</li>
<li><p> 如果如果 $HOME/.kube/config已经存在，那么需要把新的配置内容加到 $HOME/.kube/config 下。单单只是<code>cat $&#123;CONFIG_PATH&#125; &gt;&gt; $HOME/.kube/config</code>是不行的，正确的做法是：<code>KUBECONFIG=$HOME/.kube/config:$&#123;CONFIG_PATH&#125; kubectl config view --flatten &gt; $HOME/.kube/config</code> 。解释下这个命令的意思：先把所有的配置文件添加到环境变量<code>KUBECONFIG</code>中，然后执行<code>kubectl config view --flatten</code>打印出有效的配置文件内容，最后覆盖$HOME/.kube/config 即可。</p>
</li>
</ol>
<p>请注意，上述操作的优先级分别是 1&gt;2&gt;3，也就是说，kubectl 会优先检查<code>--kubeconfig</code>，若无则检查<code>KUBECONFIG</code>，若无则最后检查$HOME/.kube/config，如果还是没有，报错。但凡某一步找到了有效的 cluster，就中断检查，去连接 K8S 集群了。</p>
<p><strong>第三步：配置正确的上下文</strong></p>
<p>按照第二步的做法，如果配置文件只有一个 cluster 是没有任何问题的，但是对于有多个 cluster 怎么办呢？到这里，有几个关于配置的必须掌握的命令：</p>
<ul>
<li><p><code>kubectl config get-contexts</code>。列出所有上下文信息。</p>
<p>  <img src="http://img.blog.itpub.net/blog/2020/12/29/81e0be1ac5829f3a.jpeg?x-oss-process=style/bb"></p>
</li>
<li><p><code>kubectl config current-context</code>。查看当前的上下文信息。其实，命令 1 线束出来的*所指示的就是当前的上下文信息。</p>
<p>  <img src="http://img.blog.itpub.net/blog/2020/12/29/0992a4a267e2508e.jpeg?x-oss-process=style/bb"></p>
</li>
<li><p><code>kubectl config use-context $&#123;CONTEXT_NAME&#125;</code>。更改上下文信息。</p>
<p>  <img src="http://img.blog.itpub.net/blog/2020/12/29/2bd15b22f0369a1a.jpeg?x-oss-process=style/bb"></p>
</li>
<li><p><code>kubectl config set-context $&#123;CONTEXT_NAME&#125;|--current --$&#123;KEY&#125;=$&#123;VALUE&#125;</code>。修改上下文的元素。比如可以修改用户账号、集群信息、连接到 K8S 后所在的 namespace。</p>
<p>  <img src="http://img.blog.itpub.net/blog/2020/12/29/995ca816a3c20dfe.jpeg?x-oss-process=style/bb"></p>
<p>  关于该命令，还有几点要啰嗦的：</p>
</li>
</ul>
<ul>
<li><p>  <code>config set-context</code>可以修改任何在配置文件中的上下文信息，只需要在命令中指定上下文名称就可以。而–current 则指代当前上下文。</p>
</li>
<li><p>上下文信息所包括的内容有：cluster 集群（名称）、用户账号（名称）、连接到 K8S 后所在的 namespace，因此有<code>config set-context</code>严格意义上的用法：</p>
<p>  <code>kubectl config set-context [NAME|--current] [--cluster=cluster_nickname] [--user=user_nickname] [--namespace=namespace] [options]</code></p>
<p>  （备注：[options]可以通过 kubectl options 查看）</p>
</li>
</ul>
<p>综上，如何操作 kubectl 配置都已交代。</p>
<h3 id="IV-kubectl-部署服务"><a href="#IV-kubectl-部署服务" class="headerlink" title="IV. kubectl 部署服务"></a>IV. kubectl 部署服务</h3><p>K8S 核心功能就是部署运维容器化服务，因此最重要的就是如何又快又好地部署自己的服务了。本章会介绍如何部署 Pod 和 Deployment。</p>
<h5 id="2-1-如何部署-Pod？"><a href="#2-1-如何部署-Pod？" class="headerlink" title="2.1 如何部署 Pod？"></a>2.1 如何部署 Pod？</h5><p>通过 kubectl 部署 Pod 的办法分为两步：1). 准备 Pod 的 yaml 文件；2). 执行 kubectl 命令部署</p>
<p><strong>第一步：准备 Pod 的 yaml 文件</strong>。关于 Pod 的 yaml 文件初步解释，本系列上一篇文章《K8S 系列一：概念入门》已经有了初步介绍，这里再复习下：</p>
<p><code>apiVersion:?v1   kind:?Pod   metadata:   ??name:?memory-demo   ??namespace:?mem-example   spec:   ??containers:   ??-?name:?memory-demo-ctr   ????image:?polinux/stress   ????resources:   ??????limits:   ????????memory:?&quot;200Mi&quot;   ??????requests:   ????????memory:?&quot;100Mi&quot;   ????command:?[&quot;stress&quot;]   ????args:?[&quot;--vm&quot;,?&quot;1&quot;,?&quot;--vm-bytes&quot;,?&quot;150M&quot;,?&quot;--vm-hang&quot;,?&quot;1&quot;]   ????volumeMounts:   ????-?name:?redis-storage   ??????mountPath:?/data/redis   ??volumes:   ??-?name:?redis-storage   ????emptyDir:?&#123;&#125;   </code></p>
<p>继续解读：</p>
<ul>
<li>  <code>metadata</code>，对于新入门的同学来说，需要重点掌握的两个字段：</li>
</ul>
<ul>
<li><p>  <code>name</code>。这个 Pod 的名称，后面到 K8S 集群中查找 Pod 的关键字段。</p>
</li>
<li><p>  <code>namespace</code>。命名空间，即该 Pod 隶属于哪个 namespace 下，关于 Pod 和 namespace 的关系，上一篇文章已经交代了。</p>
</li>
</ul>
<ul>
<li>  <code>spec</code>记录了 Pod 内部所有的资源的详细信息，这里我们重点查看<code>containers</code>下的几个重要字段：</li>
</ul>
<ul>
<li><p>  <code>name</code>。Pod 下该容器名称，后面查找 Pod 下的容器的关键字段。</p>
</li>
<li><p>  <code>image</code>。容器的镜像地址，K8S 会根据这个字段去拉取镜像。</p>
</li>
<li><p><code>resources</code>。容器化服务涉及到的 CPU、内存、GPU 等资源要求。可以看到有<code>limits</code>和<code>requests</code>两个子项，那么这两者有什么区别吗，该怎么使用？在What’s the difference between Pod resources.limits and resources.requests in Kubernetes?回答了：</p>
<p>  <strong><code>limits</code>是 K8S 为该容器至多分配的资源配额；而<code>requests</code>则是 K8S 为该容器至少分配的资源配额</strong>。打个比方，配置中要求了 memory 的<code>requests</code>为 100M，而此时如果 K8S 集群中所有的 Node 的可用内存都不足 100M，那么部署服务会失败；又如果有一个 Node 的内存有 16G 充裕，可以部署该 Pod，而在运行中，该容器服务发生了内存泄露，那么一旦超过 200M 就会因为 OOM 被 kill，尽管此时该机器上还有 15G+的内存。</p>
</li>
<li><p>  <code>command</code>。容器的入口命令。对于这个笔者还存在很多困惑不解的地方，暂时挖个坑，有清楚的同学欢迎留言。</p>
</li>
<li><p>  <code>args</code>。容器的入口参数。同上，有清楚的同学欢迎留言。</p>
</li>
<li><p>  <code>volumeMounts</code>。容器要挂载的 Pod 数据卷等。请务必记住：<strong>Pod 的数据卷只有被容器挂载后才能使用</strong>！</p>
</li>
</ul>
<p><strong>第二步：执行 kubectl 命令部署</strong>。有了 Pod 的 yaml 文件之后，就可以用 kubectl 部署了，命令非常简单：<code>kubectl create -f $&#123;POD_YAML&#125;</code>。</p>
<p>随后，会提示该命令是否执行成功，比如 yaml 内容不符合要求，则会提示哪一行有问题：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/328f52b359badeff.jpeg?x-oss-process=style/bb"></p>
<p>修正后，再次部署：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/7adb153cf3477539.jpeg?x-oss-process=style/bb"></p>
<h5 id="2-2-如何部署-Deployment？"><a href="#2-2-如何部署-Deployment？" class="headerlink" title="2.2 如何部署 Deployment？"></a>2.2 如何部署 Deployment？</h5><p><strong>第一步：准备 Deployment 的 yaml 文件</strong>。首先来看 Deployment 的 yaml 文件内容：</p>
<p> <code>apiVersion:?extensions/v1beta1   ?kind:?Deployment   ?metadata:   ???name:?rss-site   ???namespace:?mem-example   ?spec:   ???replicas:?2   ???template:   ?????metadata:   ???????labels:   ?????????app:?web   ?????spec:   ??????containers:   ???????-?name:?memory-demo-ctr   ?????????image:?polinux/stress   ?????????resources:   ?????????limits:   ???????????emory:?&quot;200Mi&quot;   ?????????requests:   ???????????memory:?&quot;100Mi&quot;   ?????????command:?[&quot;stress&quot;]   ?????????args:?[&quot;--vm&quot;,?&quot;1&quot;,?&quot;--vm-bytes&quot;,?&quot;150M&quot;,?&quot;--vm-hang&quot;,?&quot;1&quot;]   ?????????volumeMounts:   ?????????-?name:?redis-storage   ???????????mountPath:?/data/redis   ?????volumes:   ?????-?name:?redis-storage   ???????emptyDir:?&#123;&#125;</code></p>
<p>继续来看几个重要的字段：</p>
<ul>
<li><p>  <code>metadata</code>同 Pod 的 yaml，这里提一点：如果没有指明 namespace，那么就是用 kubectl 默认的 namespace（如果 kubectl 配置文件中没有指明 namespace，那么就是 default 空间）。</p>
</li>
<li><p>  <code>spec</code>，可以看到 Deployment 的<code>spec</code>字段是在 Pod 的<code>spec</code>内容外“包了一层”，那就来看 Deployment 有哪些需要注意的：</p>
</li>
</ul>
<ul>
<li><p>  <code>metadata</code>，新手同学先不管这边的信息。</p>
</li>
<li><p>  <code>spec</code>，会发现这完完全全是上文提到的 Pod 的<code>spec</code>内容，在这里写明了 Deployment 下属管理的每个 Pod 的具体内容。</p>
</li>
<li><p>  <code>replicas</code>。副本个数。也就是该 Deployment 需要起多少个相同的 Pod，<strong>如果用户成功在 K8S 中配置了 n（n&gt;1）个，那么 Deployment 会确保在集群中始终有 n 个服务在运行</strong>。</p>
</li>
<li><p>  <code>template</code>。</p>
</li>
</ul>
<p><strong>第二步：执行 kubectl 命令部署</strong>。Deployment 的部署办法同 Pod：<code>kubectl create -f $&#123;DEPLOYMENT_YAML&#125;</code>。由此可见，<strong>K8S 会根据配置文件中的<code>kind</code>字段来判断具体要创建的是什么资源</strong>。</p>
<p>这里插一句题外话：<strong>部署完 deployment 之后，可以查看到自动创建了 ReplicaSet 和 Pod</strong>，如下图所示：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/a2815e26ce216800.jpeg?x-oss-process=style/bb"></p>
<p>还有一个有趣的事情：<strong>通过 Deployment 部署的服务，其下属的 RS 和 Pod 命名是有规则的</strong>。读者朋友们自己总结发现哦。</p>
<p>综上，如何部署一个 Pod 或者 Deployment 就结束了。</p>
<h3 id="V-kubectl-查看、更新-编辑、删除服务"><a href="#V-kubectl-查看、更新-编辑、删除服务" class="headerlink" title="V. kubectl 查看、更新/编辑、删除服务"></a>V. kubectl 查看、更新/编辑、删除服务</h3><p>作为 K8S 使用者而言，更关心的问题应该是本章所要讨论的话题：如何通过 kubectl 查看、更新/编辑、删除在 K8S 上部署着的服务。</p>
<h5 id="3-1-如何查看服务？"><a href="#3-1-如何查看服务？" class="headerlink" title="3.1 如何查看服务？"></a>3.1 如何查看服务？</h5><p>请务必记得一个事情：<strong>在 K8S 中，一个独立的服务即对应一个 Pod。即，当我们说要 xxx 一个服务的就是，也就是操作一个 Pod</strong>。而与 Pod 服务相关的且需要用户关心的，有 Deployment。</p>
<p>通过 kubectl 查看服务的基本命令是：</p>
<p>`$ kubectl?get|describe?${RESOURCE}?[-o?${FORMAT}]?-n=${NAMESPACE}  </p>
<h1 id="RESOURCE-有-pod、deployment、replicaset-rs"><a href="#RESOURCE-有-pod、deployment、replicaset-rs" class="headerlink" title="${RESOURCE}有:?pod、deployment、replicaset(rs)"></a>${RESOURCE}有:?pod、deployment、replicaset(rs)</h1><p>`</p>
<p>在此之前，还有一个需要回忆的事情是：Deployment、ReplicaSet 和 Pod 之间的关系 - 层层隶属；以及这些资源和 namespace 的关系是 - 隶属。如下图所示。</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/c20ccd600a5a85c9.jpeg?x-oss-process=style/bb"></p>
<p>因此，<strong>要查看一个服务，也就是一个 Pod，必须首先指定 namespace</strong>！那么，如何查看集群中所有的 namespace 呢？<code>kubectl get ns</code>：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/1f8eb4628827fa9e.jpeg?x-oss-process=style/bb"></p>
<p>于是，只需要通过<code>-n=$&#123;NAMESPACE&#125;</code>就可以指定自己要操作的资源所在的 namespace。比如查看 Pod：<code>kubectl get pod -n=oona-test</code>，同理，查看 Deployment：<code>kubectl get deployment -n=oona-test</code>。</p>
<p>问题又来了：<strong>如果已经忘记自己所部属的服务所在的 namespace 怎么办？这么多 namespace，一个一个查看过来吗？</strong></p>
<p><code>kubectl get pod --all-namespaces</code></p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/146e7c546d85fda3.jpeg?x-oss-process=style/bb"></p>
<p>这样子就可以看到所有 namespace 下面部署的 Pod 了！同理，要查找所有的命名空间下的 Deployment 的命令是：<code>kubectl get deployment --all-namespaces</code>。</p>
<p>于是，就可以开心地查看 Pod：<code>kubectl get pod [-o wide] -n=oona-test</code>，或者查看 Deployment：<code>kubectl get deployment [-o wide] -n=oona-test</code>。</p>
<p>哎，这里是否加<code>-o wide</code>有什么区别吗？实际操作下就明白了，其他资源亦然：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/4a9eac475dccf50a.jpeg?x-oss-process=style/bb"></p>
<p>哎，我们看到之前部署的 Pod 服务 memory-demo 显示的“ImagePullBackOff”是怎么回事呢？先不着急，我们慢慢看下去。</p>
<h5 id="3-2-如何更新-编辑服务？"><a href="#3-2-如何更新-编辑服务？" class="headerlink" title="3.2 如何更新/编辑服务？"></a>3.2 如何更新/编辑服务？</h5><p>两种办法：1). 修改 yaml 文件后通过 kubectl 更新；2). 通过 kubectl 直接编辑 K8S 上的服务。</p>
<p><strong>方法一：修改 yaml 文件后通过 kubectl 更新</strong>。我们看到，创建一个 Pod 或者 Deployment 的命令是<code>kubectl create -f $&#123;YAML&#125;</code>。但是，如果 K8S 集群当前的 namespace 下已经有该服务的话，会提示资源已经存在：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/32e031b17dfe8f90.jpeg?x-oss-process=style/bb"></p>
<p>通过 kubectl 更新的命令是<code>kubectl apply -f $&#123;YAML&#125;</code>，我们再来试一试：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/c4f0f8ce0878a2d3.jpeg?x-oss-process=style/bb"></p>
<p>（备注：命令<code>kubectl apply -f $&#123;YAML&#125;</code>也可以用于首次创建一个服务哦）</p>
<p><strong>方法二：通过 kubectl 直接编辑 K8S 上的服务</strong>。命令为<code>kubectl edit $&#123;RESOURCE&#125; $&#123;NAME&#125;</code>，比如修改刚刚的 Pod 的命令为<code>kubectl edit pod memory-demo</code>，然后直接编辑自己要修改的内容即可。</p>
<p>但是请注意，无论方法一还是方法二，能修改的内容还是有限的，从笔者实战下来的结论是：<strong>只能修改/更新镜像的地址和个别几个字段</strong>。如果修改其他字段，会报错：</p>
<blockquote>
<p>The Pod “memory-demo” is invalid: spec: Forbidden: pod updates may not change fields other than <code>spec.containers[*].image</code>, <code>spec.initContainers[*].image</code>, <code>spec.activeDeadlineSeconds</code> or <code>spec.tolerations</code> (only additions to existing tolerations)</p>
</blockquote>
<p>如果真的要修改其他字段怎么办呢？恐怕只能删除服务后重新部署了。</p>
<h5 id="3-3-如何删除服务？"><a href="#3-3-如何删除服务？" class="headerlink" title="3.3 如何删除服务？"></a>3.3 如何删除服务？</h5><p>在 K8S 上删除服务的操作非常简单，命令为<code>kubectl delete $&#123;RESOURCE&#125; $&#123;NAME&#125;</code>。比如删除一个 Pod 是：<code>kubectl delete pod memory-demo</code>，再比如删除一个 Deployment 的命令是：<code>kubectl delete deployment $&#123;DEPLOYMENT_NAME&#125;</code>。但是，请注意：</p>
<ul>
<li><p><strong>如果只部署了一个 Pod，那么直接删除该 Pod 即可</strong>；</p>
<p>  <img src="http://img.blog.itpub.net/blog/2020/12/29/2613ca4a3927a019.jpeg?x-oss-process=style/bb"></p>
</li>
<li><p><strong>如果是通过 Deployment 部署的服务，那么仅仅删除 Pod 是不行的，正确的删除方式应该是：先删除 Deployment，再删除 Pod</strong>。</p>
<p>  <img src="http://img.blog.itpub.net/blog/2020/12/29/71ade0a4ee1d9024.jpeg?x-oss-process=style/bb"></p>
</li>
</ul>
<p>关于第二点应该不难想象：仅仅删除了 Pod 但是 Deployment 还在的话，Deployment 定时会检查其下属的所有 Pod，如果发现失败了则会再拉起。因此，会发现过一会儿，新的 Pod 又被拉起来了。</p>
<p>另外，还有一个事情：有时候会发现一个 Pod 总也删除不了，这个时候很有可能要实施强制删除措施，命令为<code>kubectl delete pod --force --grace-period=0 $&#123;POD_NAME&#125;</code>。</p>
<h3 id="VI-kubectl-排查服务问题"><a href="#VI-kubectl-排查服务问题" class="headerlink" title="VI. kubectl 排查服务问题"></a>VI. kubectl 排查服务问题</h3><p>上文说道：部署的服务 memory-demo 失败了，是怎么回事呢？本章就会带大家一起来看看常见的 K8S 中服务部署失败、服务起来了但是不正常运行都怎么排查呢？</p>
<p>首先，祭出笔者最爱的一张 K8S 排查手册，来自博客《Kubernetes Deployment 故障排除图解指南》：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/68c4bac155425108.jpeg?x-oss-process=style/bb"></p>
<p>哈哈哈，对于新手同学来说，上图还是不够友好，下面我们简单来看两个例子：</p>
<h5 id="4-1-K8S-上部署服务失败了怎么排查？"><a href="#4-1-K8S-上部署服务失败了怎么排查？" class="headerlink" title="4.1 K8S 上部署服务失败了怎么排查？"></a>4.1 K8S 上部署服务失败了怎么排查？</h5><p>请一定记住这个命令：<code>kubectl describe $&#123;RESOURCE&#125; $&#123;NAME&#125;</code>。比如刚刚的 Pod 服务 memory-demo，我们来看：</p>
<p><img src="http://img.blog.itpub.net/blog/2020/12/29/153699f04df7ac55.jpeg?x-oss-process=style/bb"></p>
<p>拉到最后看到<code>Events</code>部分，会显示出 K8S 在部署这个服务过程的关键日志。这里我们可以看到是拉取镜像失败了，好吧，大家可以换一个可用的镜像再试试。</p>
<p>一般来说，通过<code>kubectl describe pod $&#123;POD_NAME&#125;</code>已经能定位绝大部分部署失败的问题了，当然，具体问题还是得具体分析。大家如果遇到具体的报错，欢迎分享交流。</p>
<h5 id="4-2-K8S-上部署的服务不正常怎么排查？"><a href="#4-2-K8S-上部署的服务不正常怎么排查？" class="headerlink" title="4.2 K8S 上部署的服务不正常怎么排查？"></a>4.2 K8S 上部署的服务不正常怎么排查？</h5><p>如果服务部署成功了，且状态为<code>running</code>，那么就需要进入 Pod 内部的容器去查看自己的服务日志了：</p>
<ul>
<li><p>  查看 Pod 内部某个 container 打印的日志：<code>kubectl log $&#123;POD_NAME&#125; -c $&#123;CONTAINER_NAME&#125;</code>。</p>
</li>
<li><p>  进入 Pod 内部某个 container：<code>kubectl exec -it [options] $&#123;POD_NAME&#125; -c $&#123;CONTAINER_NAME&#125; [args]</code>，嗯，这个命令的作用是通过 kubectl 执行了<code>docker exec xxx</code>进入到容器实例内部。之后，就是用户检查自己服务的日志来定位问题。</p>
</li>
</ul>
<p>显然，线上可能会遇到更复杂的问题，需要借助更多更强大的命令和工具。</p>
<h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h3><p>本文希望能够帮助对 K8S 不了解的新手快速了解 K8S。笔者一边写文章，一边查阅和整理 K8S 资料，过程中越发感觉 K8S 架构的完备、设计的精妙，是值得深入研究的，K8S 大受欢迎是有道理的。</p>
</blockquote>
<blockquote>
<p>来自 “ ITPUB博客 ” ，链接：<a target="_blank" rel="noopener" href="http://blog.itpub.net/31559354/viewspace-2746071/">http://blog.itpub.net/31559354/viewspace-2746071/</a></p>
</blockquote>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。也可以邮件至 1209453173@qq.com </span>
    </div>
</article>







    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Copyright©2016-至今   张天师
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 572px;
    }
    .nav.fullscreen {
        margin-left: -572px;
    }
    .nav-left {
        width: 150px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 542px;
        }
        .nav.fullscreen {
            margin-left: -542px;
        }
        .nav-left {
            width: 150px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 542px;
            margin-left: -542px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
